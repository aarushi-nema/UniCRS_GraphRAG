2025-02-01 13:20:32.407 | INFO     | __main__:<module>:90 - Distributed environment: NO
Num processes: 1
Process index: 0
Local process index: 0
Device: cuda

Mixed precision type: no

2025-02-01 13:20:32.408 | INFO     | __main__:<module>:91 - {'seed': 42, 'output_dir': '/home/Nema/UniCRS_GraphRAG/UniCRS/src/conversation_prompt', 'debug': False, 'dataset': 'redial', 'num_workers': 0, 'context_max_length': 200, 'resp_max_length': 183, 'entity_max_length': 32, 'prompt_max_length': 200, 'tokenizer': 'microsoft/DialoGPT-small', 'ignore_pad_token_for_loss': True, 'text_tokenizer': None, 'model': 'microsoft/DialoGPT-small', 'max_gen_len': 50, 'text_encoder': None, 'prompt_encoder': '/home/Nema/UniCRS_GraphRAG/UniCRS/src/pretrained_prompt/best', 'n_prefix_conv': 20, 'num_bases': 8, 'num_train_epochs': 10, 'max_train_steps': None, 'per_device_train_batch_size': 8, 'per_device_eval_batch_size': 16, 'gradient_accumulation_steps': 1, 'learning_rate': 0.0001, 'weight_decay': 0.01, 'max_grad_norm': None, 'num_warmup_steps': 6345, 'mixed_precision': 'no', 'use_wandb': False, 'entity': None, 'project': None, 'name': None, 'log_all': False}
2025-02-01 13:22:21.232 | INFO     | __main__:<module>:254 - ***** Running training *****
2025-02-01 13:22:21.233 | INFO     | __main__:<module>:255 -   Num examples = 102452
2025-02-01 13:22:21.233 | INFO     | __main__:<module>:256 -   Num Epochs = 10
2025-02-01 13:22:21.233 | INFO     | __main__:<module>:257 -   Instantaneous batch size per device = 8
2025-02-01 13:22:21.233 | INFO     | __main__:<module>:258 -   Total train batch size (w. parallel, distributed & accumulation) = 8
2025-02-01 13:22:21.233 | INFO     | __main__:<module>:259 -   Gradient Accumulation steps = 1
2025-02-01 13:22:21.233 | INFO     | __main__:<module>:260 -   Total optimization steps = 128070
2025-02-01 13:46:26.452 | INFO     | __main__:<module>:308 - epoch 0 train loss 2.6294753266281887
2025-02-01 13:54:15.332 | INFO     | __main__:<module>:356 - {'valid/bleu@1': 0.15958073344028734, 'valid/bleu@2': 0.035878776057588, 'valid/bleu@3': 0.012763495800290745, 'valid/bleu@4': 0.005986873869573417, 'valid/dist@1': 0.21351469942957438, 'valid/dist@2': 0.5842035980693286, 'valid/dist@3': 0.9186485300570426, 'valid/dist@4': 1.1969284774023694, 'valid/item_ratio': 0.0009653356735410268, 'valid/sent_cnt': 11395, 'valid/loss': 2.214422818821911, 'epoch': 0}
2025-02-01 13:54:15.576 | INFO     | __main__:<module>:364 - new best model with loss
2025-02-01 14:03:47.252 | INFO     | __main__:<module>:411 - {'test/bleu@1': 0.15390609901734675, 'test/bleu@2': 0.030670098081889894, 'test/bleu@3': 0.009955786048985577, 'test/bleu@4': 0.00434575230433986, 'test/dist@1': 0.17929257763542683, 'test/dist@2': 0.5009051664113633, 'test/dist@3': 0.8126305528477928, 'test/dist@4': 1.0825790279905305, 'test/item_ratio': 0.000487397298426403, 'test/sent_cnt': 14362, 'test/loss': 2.249984351192126, 'epoch': 0}
2025-02-01 14:27:58.876 | INFO     | __main__:<module>:308 - epoch 1 train loss 2.0637627419779805
2025-02-01 14:36:26.248 | INFO     | __main__:<module>:356 - {'valid/bleu@1': 0.16544505417374658, 'valid/bleu@2': 0.040167299678608485, 'valid/bleu@3': 0.01588358916469104, 'valid/bleu@4': 0.007445719867796846, 'valid/dist@1': 0.25362000877577884, 'valid/dist@2': 0.7416410706450197, 'valid/dist@3': 1.19482229047828, 'valid/dist@4': 1.560070206230803, 'valid/item_ratio': 8.775778850372971e-05, 'valid/sent_cnt': 11395, 'valid/loss': 2.1051235090298537, 'epoch': 1}
2025-02-01 14:36:26.595 | INFO     | __main__:<module>:364 - new best model with loss
2025-02-01 14:46:57.953 | INFO     | __main__:<module>:411 - {'test/bleu@1': 0.15752366643787089, 'test/bleu@2': 0.03122794506443396, 'test/bleu@3': 0.011648459824086035, 'test/bleu@4': 0.005751225889471678, 'test/dist@1': 0.2196072970338393, 'test/dist@2': 0.6627210694889292, 'test/dist@3': 1.1017267790001393, 'test/dist@4': 1.4770226987884696, 'test/item_ratio': 0.0001392563709789723, 'test/sent_cnt': 14362, 'test/loss': 2.1641124975442354, 'epoch': 1}
2025-02-01 15:11:09.412 | INFO     | __main__:<module>:308 - epoch 2 train loss 1.9080063343848594
2025-02-01 15:19:03.327 | INFO     | __main__:<module>:356 - {'valid/bleu@1': 0.16118911683635073, 'valid/bleu@2': 0.03711632875835737, 'valid/bleu@3': 0.013862406290924268, 'valid/bleu@4': 0.005998790434527352, 'valid/dist@1': 0.2692408951294427, 'valid/dist@2': 0.8047389205792014, 'valid/dist@3': 1.2864414216761737, 'valid/dist@4': 1.6603773584905661, 'valid/item_ratio': 8.775778850372971e-05, 'valid/sent_cnt': 11395, 'valid/loss': 2.0873404067495596, 'epoch': 2}
2025-02-01 15:19:03.637 | INFO     | __main__:<module>:364 - new best model with loss
2025-02-01 15:28:40.586 | INFO     | __main__:<module>:411 - {'test/bleu@1': 0.15495485766511932, 'test/bleu@2': 0.029639636767703596, 'test/bleu@3': 0.009907084228460268, 'test/bleu@4': 0.003955263667114541, 'test/dist@1': 0.21535997771898063, 'test/dist@2': 0.6619551594485448, 'test/dist@3': 1.0907255256928003, 'test/dist@4': 1.4485447709232697, 'test/item_ratio': 0.0001392563709789723, 'test/sent_cnt': 14362, 'test/loss': 2.159082428915198, 'epoch': 2}
2025-02-01 15:52:53.128 | INFO     | __main__:<module>:308 - epoch 3 train loss 1.787663903040546
2025-02-01 16:01:10.005 | INFO     | __main__:<module>:356 - {'valid/bleu@1': 0.16369247573126944, 'valid/bleu@2': 0.03864580904026906, 'valid/bleu@3': 0.014589930695146235, 'valid/bleu@4': 0.007411313117469226, 'valid/dist@1': 0.2946028960070206, 'valid/dist@2': 0.8999561211057482, 'valid/dist@3': 1.4293111013602458, 'valid/dist@4': 1.8278192189556823, 'valid/item_ratio': 0.00035103115401491884, 'valid/sent_cnt': 11395, 'valid/loss': 2.1097708129615302, 'epoch': 3}
2025-02-01 16:11:19.771 | INFO     | __main__:<module>:411 - {'test/bleu@1': 0.15377833617872208, 'test/bleu@2': 0.02868910695618796, 'test/bleu@3': 0.009788068626895395, 'test/bleu@4': 0.00451474651806333, 'test/dist@1': 0.24000835538225873, 'test/dist@2': 0.7556050689319036, 'test/dist@3': 1.2419579445759643, 'test/dist@4': 1.6352875644060716, 'test/item_ratio': 0.0001392563709789723, 'test/sent_cnt': 14362, 'test/loss': 2.194708255324969, 'epoch': 3}
2025-02-01 16:35:33.732 | INFO     | __main__:<module>:308 - epoch 4 train loss 1.6766477189373428
2025-02-01 16:43:48.453 | INFO     | __main__:<module>:356 - {'valid/bleu@1': 0.16198612090709863, 'valid/bleu@2': 0.03818942873336378, 'valid/bleu@3': 0.015134865683058213, 'valid/bleu@4': 0.007105917631036039, 'valid/dist@1': 0.30759104870557263, 'valid/dist@2': 0.9422553751645458, 'valid/dist@3': 1.5074155331285652, 'valid/dist@4': 1.9161913119789382, 'valid/item_ratio': 0.00026327336551118914, 'valid/sent_cnt': 11395, 'valid/loss': 2.166829673471491, 'epoch': 4}
2025-02-01 16:53:53.976 | INFO     | __main__:<module>:411 - {'test/bleu@1': 0.15528852502225743, 'test/bleu@2': 0.030455017082291546, 'test/bleu@3': 0.010866164066261483, 'test/bleu@4': 0.004871307157699012, 'test/dist@1': 0.24293273917281716, 'test/dist@2': 0.7901406489346887, 'test/dist@3': 1.3187578331708676, 'test/dist@4': 1.7384069071160007, 'test/item_ratio': 0.0001392563709789723, 'test/sent_cnt': 14362, 'test/loss': 2.26148506607404, 'epoch': 4}
2025-02-01 17:18:10.304 | INFO     | __main__:<module>:308 - epoch 5 train loss 1.57102726662737
2025-02-01 17:26:45.083 | INFO     | __main__:<module>:356 - {'valid/bleu@1': 0.16258834005649703, 'valid/bleu@2': 0.03800522192533887, 'valid/bleu@3': 0.014833770074275747, 'valid/bleu@4': 0.007096764277807948, 'valid/dist@1': 0.35761298815269854, 'valid/dist@2': 1.148661693725318, 'valid/dist@3': 1.8509872751206669, 'valid/dist@4': 2.3550680122860905, 'valid/item_ratio': 0.0, 'valid/sent_cnt': 11395, 'valid/loss': 2.2288364795615263, 'epoch': 5}
2025-02-01 17:37:08.439 | INFO     | __main__:<module>:411 - {'test/bleu@1': 0.1527961537005714, 'test/bleu@2': 0.028806415332831764, 'test/bleu@3': 0.00974346080963858, 'test/bleu@4': 0.004066719232474046, 'test/dist@1': 0.28018381840969225, 'test/dist@2': 0.9454811307617323, 'test/dist@3': 1.5855730399665784, 'test/dist@4': 2.060158752262916, 'test/item_ratio': 6.962818548948615e-05, 'test/sent_cnt': 14362, 'test/loss': 2.3259486079481504, 'epoch': 5}
2025-02-01 18:01:23.097 | INFO     | __main__:<module>:308 - epoch 6 train loss 1.4745463759761193
2025-02-01 18:09:36.451 | INFO     | __main__:<module>:356 - {'valid/bleu@1': 0.15910949595981605, 'valid/bleu@2': 0.03720572072829416, 'valid/bleu@3': 0.014613183637038228, 'valid/bleu@4': 0.007088086710579323, 'valid/dist@1': 0.3569109258446687, 'valid/dist@2': 1.1533128565160158, 'valid/dist@3': 1.8510750329091707, 'valid/dist@4': 2.333479596314173, 'valid/item_ratio': 0.0005265467310223783, 'valid/sent_cnt': 11395, 'valid/loss': 2.3225035142430417, 'epoch': 6}
2025-02-01 18:19:43.417 | INFO     | __main__:<module>:411 - {'test/bleu@1': 0.1505459160513589, 'test/bleu@2': 0.0280928078712589, 'test/bleu@3': 0.009849842200463595, 'test/bleu@4': 0.004365702810793967, 'test/dist@1': 0.28665923966021445, 'test/dist@2': 0.9675532655618995, 'test/dist@3': 1.6100821612588776, 'test/dist@4': 2.076173234925498, 'test/item_ratio': 0.0007659100403843476, 'test/sent_cnt': 14362, 'test/loss': 2.426147680107363, 'epoch': 6}
2025-02-01 18:43:59.739 | INFO     | __main__:<module>:308 - epoch 7 train loss 1.3893987524655567
2025-02-01 18:52:34.310 | INFO     | __main__:<module>:356 - {'valid/bleu@1': 0.160855911978718, 'valid/bleu@2': 0.03765624546329052, 'valid/bleu@3': 0.014456493872631582, 'valid/bleu@4': 0.006763357650770368, 'valid/dist@1': 0.38420359806932863, 'valid/dist@2': 1.2553751645458535, 'valid/dist@3': 2.0215006581834136, 'valid/dist@4': 2.5382185168933744, 'valid/item_ratio': 0.0007020623080298377, 'valid/sent_cnt': 11395, 'valid/loss': 2.3924145071570035, 'epoch': 7}
2025-02-01 19:02:56.777 | INFO     | __main__:<module>:411 - {'test/bleu@1': 0.15244417792094284, 'test/bleu@2': 0.029191417528834657, 'test/bleu@3': 0.009729547532514498, 'test/bleu@4': 0.004110247097764156, 'test/dist@1': 0.29933156941930095, 'test/dist@2': 1.0460938587940398, 'test/dist@3': 1.7455786102214177, 'test/dist@4': 2.2524021723993872, 'test/item_ratio': 0.0002785127419579446, 'test/sent_cnt': 14362, 'test/loss': 2.498078099470627, 'epoch': 7}
2025-02-01 19:27:12.761 | INFO     | __main__:<module>:308 - epoch 8 train loss 1.316503938796826
2025-02-01 19:35:42.249 | INFO     | __main__:<module>:356 - {'valid/bleu@1': 0.15960309458929645, 'valid/bleu@2': 0.03679735321626324, 'valid/bleu@3': 0.014146531169795199, 'valid/bleu@4': 0.00676754238338911, 'valid/dist@1': 0.40368582711715667, 'valid/dist@2': 1.318209741114524, 'valid/dist@3': 2.1109258446687145, 'valid/dist@4': 2.6355419043440107, 'valid/item_ratio': 0.001228609039052216, 'valid/sent_cnt': 11395, 'valid/loss': 2.4650415596754653, 'epoch': 8}
2025-02-01 19:46:08.544 | INFO     | __main__:<module>:411 - {'test/bleu@1': 0.15093694812454678, 'test/bleu@2': 0.028068866878194876, 'test/bleu@3': 0.00970247561914551, 'test/bleu@4': 0.004340899905667438, 'test/dist@1': 0.3126305528477928, 'test/dist@2': 1.0889848210555633, 'test/dist@3': 1.8258599080907951, 'test/dist@4': 2.3544074641414845, 'test/item_ratio': 0.000974794596852806, 'test/sent_cnt': 14362, 'test/loss': 2.5731858592521903, 'epoch': 8}
2025-02-01 20:10:22.596 | INFO     | __main__:<module>:308 - epoch 9 train loss 1.2607032398741187
2025-02-01 20:18:59.487 | INFO     | __main__:<module>:356 - {'valid/bleu@1': 0.1598992403702987, 'valid/bleu@2': 0.03782020610223696, 'valid/bleu@3': 0.014715923571876517, 'valid/bleu@4': 0.007359114691557056, 'valid/dist@1': 0.40868802106186924, 'valid/dist@2': 1.3645458534444932, 'valid/dist@3': 2.1966652040368584, 'valid/dist@4': 2.7455901711276876, 'valid/item_ratio': 0.001228609039052216, 'valid/sent_cnt': 11395, 'valid/loss': 2.52178081456274, 'epoch': 9}
2025-02-01 20:29:35.996 | INFO     | __main__:<module>:411 - {'test/bleu@1': 0.15158706512422668, 'test/bleu@2': 0.028270143911277017, 'test/bleu@3': 0.009662911915031474, 'test/bleu@4': 0.00435887874500365, 'test/dist@1': 0.33094276563152764, 'test/dist@2': 1.1519983289235483, 'test/dist@3': 1.9383790558418048, 'test/dist@4': 2.496170449798078, 'test/item_ratio': 0.0008355382258738338, 'test/sent_cnt': 14362, 'test/loss': 2.6310604436360383, 'epoch': 9}
2025-02-01 20:29:36.248 | INFO     | __main__:<module>:420 - save final model

'test/dist@1': 0.33094276563152764, 
'test/dist@2': 1.1519983289235483, 
'test/dist@3': 1.9383790558418048, 
'test/dist@4': 2.496170449798078

'test/loss': 2.6310604436360383